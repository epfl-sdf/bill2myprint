{% extends "bill2myprint/base.html" %}


{% block template_main %}
<h1>Facultés</h1>

<form id="faculty_form" action="{% url 'default_faculties' %}" method="POST">{% csrf_token %}
    <div class="row">
        <div class="col-md-4">
            <h4>Faculté: </h4>
        </div>
        <div class="col-md-8">
            <input type="hidden" id="faculty" name="faculty" value="{{ current_faculty }}"/>
            <div id="faculties_faculty" class="btn-group">
                <label class="dropdown-toggle" data-toggle="dropdown">
                    {{ current_faculty }}  <span class="caret"></span>
                </label>
                <ul class="dropdown-menu scrollable-menu" role="menu">
                    {% for faculty in faculties %}
                    <li><label>{{ faculty }}</label></li>
                    {% endfor %}
                </ul>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-md-4">
            <h4>Semestre: </h4>
        </div>
        <div class="col-md-8">
            <input type="hidden" id="semester" name="semester" value="{{ current_semester }}"/>
            <div id="faculties_semester" class="btn-group">
                <label class="dropdown-toggle" data-toggle="dropdown">
                    {{ current_semester }}  <span class="caret"></span>
                </label>
                <ul class="dropdown-menu scrollable-menu" role="menu">
                    {% for semester in semesters %}
                    <li><label>{{ semester }}</label></li>
                    {% endfor %}
                </ul>
            </div>
        </div>
    </div>
</form>

<div class="row">
    <div class="col-md-4">
        <h4>Nombre d'étudiants: </h4>
    </div>
    <div class="col-md-8">
        <h4>{{ number_of_students }}</h4>
    </div>
</div>

<div class="row" style="margin-top: 30px;">
    <div>
        <table data-toggle="table" class="table table-striped table-bordered table-hover">
            <thead>
                <tr>
                    <th data-field="section" data-sortable="true">Section</th>
                    <th data-field="vpsi" data-sortable="true">Crédit VPSI</th>
                    <th data-field="faculty" data-sortable="true">Crédit section</th>
                    <th data-field="students" data-sortable="true">Crédit étudiant</th>
                    <th data-field="amount" data-sortable="true">Dépense étudiant</th>
                    <th data-field="bill" data-sortable="true">Facturation</th>
                </tr>
            </thead>
            <tbody>
                {% for section in sections_data %}
                <tr>
                    <td><a href="{% url 'sections' faculty=current_faculty section=section.section semester=current_semester %}">{{ section.section }}</a></td>
                    <td>{{ section.vpsi }}</td>
                    <td>{{ section.faculty }}</td>
                    <td>{{ section.add_students }}</td>
                    <td>{{ section.students }}</td>
                    <td>{{ section.amount }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}

        {% comment %}
{% load static %}
{% load templatetags %}


{# .... List of semesters to choose from .... #}
{% if semesters %}
    <form action="{% url 'default_faculties' %}" method="POST">{% csrf_token %}
        {% for sem in semesters %}
        <label for="{{ sem }}">{{ sem }}</label>
        <input type="checkbox" name="semesters[]" id="{{ sem }}" value="{{ sem }}">
        <br>
        {% endfor %}

        <input type="submit">
    </form>
{% else %}
    <p>La liste des semestres n'a pas pu être récuperée</p>
{% endif %}

{# .... Pagination section .... #}
{% if is_paginated %}
<div class="pagination">
    <span class="page-links">
        {% if page_obj.has_previous %}
        <a href="?page={{ page_obj.previous_page_number }}">previous</a>
        {% endif %}
        <span class="page-current">
            Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}.
        </span>
        {% if page_obj.has_next %}
        <a href="?page={{ page_obj.next_page_number }}">next</a>
        {% endif %}
    </span>
</div>
{% endif %}

<div class="row">
    <div>
        {% if faculties %}
        <table data-toggle="table" class="table table-striped table-bordered table-hover">
            <thead>
                <tr>
                    <th data-field="faculty" data-sortable="true">Faculté</th>
                    <th data-field="semestre" data-sortable="true">Semestre</th>
                    <th data-field="vpsi" data-sortable="true">Crédits VPSI</th>
                    <th data-field="fac" data-sortable="true">Crédit Faculté</th>
                    <th data-field="spent" data-sortable="true">Dépense des étudiants</th>
                </tr>
            </thead>
            <tbody>
                {% for fac in faculties %}
                <tr>
                    <td>{{ fac.section__faculty__name }}</td>
                    <td>{{ fac.semester__name }}</td>
                    <td>{{ fac.vpsi }}</td>
                    <td>{{ fac.fac }}</td>
                    <td>{{ fac.conso }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        {% else %}
        <p>Seléctionnez un semestre pour voir les données</p>
        {% endif %}
    </div>
</div>

{# .... Pagination section .... #}
{% if is_paginated %}
<div class="pagination">
    <span class="page-links">
        {% if page_obj.has_previous %}
        <a href="?page={{ page_obj.previous_page_number }}">previous</a>
        {% endif %}
        <span class="page-current">
            Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}.
        </span>
        {% if page_obj.has_next %}
        <a href="?page={{ page_obj.next_page_number }}">next</a>
        {% endif %}
    </span>
</div>
{% endif %}

    {% endcomment %}
